<!DOCTYPE html>
<html>
  <head>
    <title><%= OasRails.config.info.title %></title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <meta charset="utf-8">
    <!-- Important: rapi-doc uses utf8 characters -->
    <script type="module" src="/oas-rails-assets/rapidoc-min.js"></script>
    <script>
      function applyTheme() {
        const docEl = document.querySelector('rapi-doc');
       
       const themeAttributes = <%= rapidoc_theme_attributes.to_json.html_safe %>;
        themeAttributes.forEach(attr => {
          docEl.removeAttribute(attr);
        });

        const themeConfig = <%= rapidoc_theme(OasRails.config.rapidoc_theme).to_json.html_safe %>;
        Object.entries(themeConfig).forEach(([key, value]) => {
          docEl.setAttribute(key, value);
        });
      }

      document.addEventListener('DOMContentLoaded', applyTheme);
    </script>
  </head>
  <body>
    <rapi-doc <%= rapidoc_configuration_attributes %> >
      <% if rapidoc_logo_url %>
        <img
          slot="nav-logo"
          src="<%= rapidoc_logo_url %>"
        />
      <% end %>
    </rapi-doc>

    <style>
      rapi-doc::part(btn btn-outline) {
        width: 220px;
        min-width: 170px;
      }
    </style>
  </body>
</html>
